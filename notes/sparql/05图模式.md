# SPARQL 1.1 Query Language

W3C Recommendation 21 March 2013

[原文地址](https://www.w3.org/TR/sparql11-query/)

## 5. 图模式(Graph Pattern)

SPARQL是基于图模式匹配的，更多复杂的图模式可以通过结合更小的模式来组合而成。

* 基础图模式(Basis Graph Pattern):必须匹配给出所有三元组
* 组图模式(Group Graph Pattern):必须匹配给出所有图模式
* 可选图模式(Optional Graph Pattern):可以通过附加的模式来扩展匹配结果
* 可替代图模式(Alternative Graph Pattern):尝试至少两个可能的模式进行匹配
* 命名图模式(Patterns on Named Graphs):在非命名图中匹配模式

### 5.1 基础图模式

基础的图模式的组成有两部分：

* 一系列的三元组模式
* 附加的filter

SPARQL通过子图匹配来计算基本图模式，子图匹配的机制使用的预定义好的，[定义的文档](http://www.w3.org/TR/sparql11-entailment/)，匹配机制可以被扩展。

### 5.2 组图模式

在一个SPARQL语句查询中，一组图模式使用`{}`进行包裹，例如

```
PREFIX foaf:  <http://xmlns.com/foaf/0.1/>
SELECT ?name ?mbox
WHERE {
    {
        ?x foaf:name ?name .
    }
    {
        ?x foaf:mbox ?mbox .
    }
}
```

示例代码中，就有一组图模式，由两个基础的图模式组成，两个基础的图模式中各有一个三元组模式。

在前几章中，我们的查询语句都是

```
PREFIX foaf:    <http://xmlns.com/foaf/0.1/>
SELECT ?name ?mbox
WHERE  {
          ?x foaf:name ?name .
          ?x foaf:mbox ?mbox .
       }
```

实际上查询的模式也是组图模式，只是这一组图模式中只包含了一个基本的图模式。

#### 5.2.1 空组模式

一个空的组模式，其实就是

```
{}
```

#### 5.2.2 Filter作用范围

一个FILTER的作用范围为该FILTER出现的组图模式，即出现的那个`{}`。

例如，以下三种写法效果都是一样的。

```
// 写法1
{  ?x foaf:name ?name .
    ?x foaf:mbox ?mbox .
    FILTER regex(?name, "Smith")
 }

 // 写法2
 {  FILTER regex(?name, "Smith")
    ?x foaf:name ?name .
    ?x foaf:mbox ?mbox .
 }

 // 写法3
 {  ?x foaf:name ?name .
    FILTER regex(?name, "Smith")
    ?x foaf:mbox ?mbox .
 }
```







